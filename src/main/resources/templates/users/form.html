<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title th:text="${isEdit} ? 'Edit User' : 'Create User'">User Form</title>
    <!-- External stylesheets -->
    <link rel="stylesheet" th:href="@{/css/common.css}">
    <link rel="stylesheet" th:href="@{/css/form.css}">
</head>
<body>
    <!-- Thymeleaf conditional text -->
    <h1 th:text="${isEdit} ? 'Edit User' : 'Create New User'">User Form</h1>

    <div class="form-container">
        <!--
            Thymeleaf form with dynamic action:
            - If editing: POST to /ui/users/{id} with _method=PUT
            - If creating: POST to /ui/users
        -->
        <form th:action="${isEdit} ? '/ui/users/' + ${userId} : '/ui/users'"
              method="post"
              th:object="${user}">

            <!-- Hidden field for PUT method when editing -->
            <input th:if="${isEdit}" type="hidden" name="_method" value="PUT">

            <!-- Name Field -->
            <div class="form-group">
                <label for="name">
                    Name <span class="required">*</span>
                </label>
                <!-- Thymeleaf field binding with th:field -->
                <input type="text"
                       id="name"
                       th:field="*{name}"
                       required
                       placeholder="Enter full name">
                <div class="help-text">Enter the user's full name</div>
            </div>

            <!-- Email Field -->
            <div class="form-group">
                <label for="email">
                    Email <span class="required">*</span>
                </label>
                <input type="email"
                       id="email"
                       th:field="*{email}"
                       required
                       placeholder="user@example.com">
                <div class="help-text">Enter a valid email address</div>
            </div>

            <!-- Password Field (only show when creating new user) -->
            <div th:if="${!isEdit}" class="form-group">
                <label for="password">
                    Password <span class="required">*</span>
                </label>
                <!-- Use name attribute directly instead of th:field to avoid binding error -->
                <input type="password"
                       id="password"
                       name="password"
                       required
                       placeholder="Enter password">
                <div class="help-text">Enter a secure password</div>
            </div>

            <!-- Buttons -->
            <div class="button-group">
                <button type="submit" class="btn btn-primary"
                        th:text="${isEdit} ? 'Update User' : 'Create User'">
                    Submit
                </button>
                <a href="/ui/users" class="btn btn-secondary">Cancel</a>
            </div>
        </form>
    </div>

</body>
</html>

